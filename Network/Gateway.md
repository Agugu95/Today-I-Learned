# Gateway/Tunneling
네트워크 프로토콜에서 게이트웨이와 터널링, 릴레이를 알아봄  

## 게이트웨이란?  
기본적으로 하나의 프로토콜을 사용하는 프로그램은 동일한 프로토콜로의 전송밖에 할 수가 없다.  
SMTP를 사용하는 메일 프로그램은 SMTP를 사용하는 사람만 받을 수 있고, HTTP도 마찬가지다.  
이러한 프로토콜들을 확장 사용하기 위하여 Gateway(관문)이 나왔다.  
Gateway는 각 프로토콜의 끝단에 위치하여 송/수신 트래픽을 각각에 맞는 프로토콜로 자동 변환 시켜준다.  
웹에서 게이트웨이는 보통 '/'을 사용하여 송/수신 트래픽을 구분하고, HTTP 트래픽을 받아 FTP로 변환 시킨다면 이는 HTTP/FTP Gateway에 해당된다.  
게이트웨이는 게이트웨이의 아웃바운드가 어떠한 역할을 수행하는지에 따라서 나뉘는데  
- HTTP/* 웹 게이트웨이    
- HTTP/HTTPS 보안 게이트웨이와 HTTPS/HTTP 보안 가속 게이트웨이  
이 둘은 HTTP 트래픽의 경우 보안이 되지 않은 상태이기 때문에 신뢰성이 확보된 곳에서 사용해야한다.  
18년 경에 있었던 [HTTPS 검열 이슈](https://m.post.naver.com/viewer/postView.nhn?volumeNo=17893147&memberNo=19850389&vType=VERTICAL)도 
바로 여기에서 비롯된건데 전공자들이 말했던 통신 감청은 아니지만, 보안 상의 취약점을 이용하는 것이 과연 옳은지에 대한 것이다.  
나라에서 ISP에 대해서 요구했지만 만약 개인이 했던거라면 트래픽을 가로채는 명백한 보안 취약점 공격이었기때문이다.   

- 리소스 게이트웨이  
클라이언트와 서버 간의 게이트웨이보다는 서버 게이트웨이가 많이 사용 되는데, 이는 서버의 요청으로부터 리소스를 처리하기 위함이다.  
여러 개의 클라이언트 요청이 들어온다면 서버는 본인이 작업을 처리하는게 아닌 API(Application Programing Interface)를 통해 실제로 전달받게 된다.  
여기에는 CGI(Common Gateway Interface)가 표준으로 쓰이며 URL을 통한 쿼리 수신을 CGI가 각 게이트웨이 프로세스에 따라 처리한다.  
(자바의 경우라면 WAS인 Tomcat이 해주는 역할)  

이렇게 게이트웨이를 사용하면 각 애플리케이션 사이에서 동일하지 않은 프로토콜로도 통신을 할 수 있고, 이는 인터페이스에 의해 가능하다.  
인터페이스 표준은 HTTP위에서 데이터를 담는 방식으로 개발 되는데 전에는 SOAP(Simple Object Application Protocol)과 XML(eXtensible Markup Language)가  
현재는 REST(Representational State Transfer)와 JSON(JavaScript Object Notation)이 주로 쓰인다.  

## 게이트웨이와 프록시의 차이  
프록시의 역할에도 HTTP1.0과 HTTP2.0이 통신하는 것이 있긴하지만 엄밀히 말하면 동일한 프로토콜을 사용하는 것이기에 이는 프록시다.  
정리하자면 동일 프로토콜 내라면 프록시, 서로 다른 프로토콜이라면 게이트웨이  
 
## 게이트웨이 터널링
그렇다면 정녕 동일 커넥션에는 동일 트래픽밖에 보낼 수 없는걸까?  
놀랍게도 HTTP 커넥션에서도 다른 프로토콜의 트래픽을 보내기 위한 Tunnel이 존재한다.  
만약 서버와 SSL 커넥션을 맺고 싶다면 클라이언트가 서버와 바로 SSL 커넥션을 맺지않고 싶다면 트래픽 요청과 서버 게이트웨이 간에만 형성된다.  
이는 실제로는 서버와 클라이언트가 SSL 커넥션을 직접적으로 맺고있지 않음에도 SSL 커넥션으로 데이터가 전송 될 수 있게 해준다.  
[SSL 터널링](https://www.geeksforgeeks.org/what-is-ssl-tunneling/)  

